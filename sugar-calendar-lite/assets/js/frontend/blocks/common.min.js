var SugarCalendarBlocks=window.SugarCalendarBlocks||function(o){const t={init(){o(t.ready)},ready(){t.setupDatepickerI18n(),o("body").on("click",t.events.closePopoversOnBodyClick)},events:{closePopoversOnBodyClick(e){!o(this).hasClass("sugar-calendar-block__popovers__active")||(e=o(e.target)).hasClass("sugar-calendar-block__controls__left__date")||e.hasClass("sugar-calendar-block__controls__right__settings__btn")||e.hasClass("sugar-calendar-block__controls__right__view__btn")||e.hasClass("sugar-calendar-block__event-cell")||e.hasClass("sugar-calendar-block__popover")||0<e.parents(".sugar-calendar-block__controls__left__date").length||0<e.parents(".sugar-calendar-block__controls__right__settings__btn").length||0<e.parents(".sugar-calendar-block__controls__right__view__btn").length||0<e.parents(".sugar-calendar-block__event-cell").length||0<e.parents(".sugar-calendar-block__popover").length||t.hideAllPopovers()}},hideAllPopovers(){var e=o("body");e.find(".sugar-calendar-block__popover").removeClass("sugar-calendar-block__controls__settings__btn_active").hide(),e.find(".sugar-calendar-block__controls__settings__btn").removeClass("sugar-calendar-block__controls__settings__btn_active"),e.find(".sugar-calendar-block__controls__left__date").removeClass("sugar-calendar-block__controls__settings__btn_active"),e.removeClass("sugar-calendar-block__popovers__active")},setupDatepickerI18n(){var e=sc_frontend_blocks_common_obj.settings.locale;o.fn.scbootdatepicker.dates[e]={days:sc_frontend_blocks_common_obj.settings.i18n.days,daysShort:sc_frontend_blocks_common_obj.settings.i18n.daysShort,daysMin:sc_frontend_blocks_common_obj.settings.i18n.daysMin,months:sc_frontend_blocks_common_obj.settings.i18n.months,monthsShort:sc_frontend_blocks_common_obj.settings.i18n.monthsShort}}};return t}((document,window,jQuery));SugarCalendarBlocks.init(),SugarCalendarBlocks.Controls=SugarCalendarBlocks.Controls||function(e){this.$blockContainer=e,this.$baseContainer=e.find(".sugar-calendar-block__base-container"),this.$datePicker=e.find(".sugar-calendar-block__controls__datepicker"),this.$formContainer=e.find(".sugar-calendar-block-settings"),this.$searchContainer=e.find(".sugar-calendar-block__controls__right__search__field"),this.$searchClear=e.find(".sugar-calendar-block__controls__right__search__clear"),this.$timeOfDayContainer=e.find(".sugar-calendar-block__popover__calendar_selector__container__time"),this.$daysOfWeekContainer=e.find(".sugar-calendar-block__popover__calendar_selector__container__days"),this.initDatePicker(),this.popovers=new SugarCalendarBlocks.Controls.Popovers(this),this.$blockContainer.find(".sugar-calendar-block__popover__display_selector__container__body__option").on("click",this.onChangeDisplay.bind(this)),this.$blockContainer.find(".sugar-calendar-block__controls__left__pagination__prev").on("click",this.goToPrevious.bind(this)),this.$blockContainer.find(".sugar-calendar-block__controls__left__pagination__next").on("click",this.goToNext.bind(this)),this.$blockContainer.find(".sugar-calendar-block__controls__left__pagination__current").on("click",this.goToCurrent.bind(this)),this.$searchContainer.on("keyup",this.onSearch.bind(this)),this.$searchContainer.on("focus",this.onSearchFieldFocus.bind(this)),this.$searchContainer.on("focusout",this.onSearchFieldFocusOut.bind(this)),this.$blockContainer.find(".sugar-calendar-block__controls__right__search__icon").on("click",this.onSearchClick.bind(this)),this.$searchClear.on("click",this.onClearSearch.bind(this)),this.$blockContainer.on("block:preupdate",this.onPreUpdate.bind(this)),this.$blockContainer.on("block:postupdate",this.onPostUpdate.bind(this))},SugarCalendarBlocks.Controls.prototype.onPreUpdate=function(e,o){this.$baseContainer.addClass("sugar-calendar-block__loading-state"),this.$baseContainer.prepend('<div class="sugar-calendar-block__base-container__overlay"><div class="sugar-calendar-block__loading"></div></div>')},SugarCalendarBlocks.Controls.prototype.onPostUpdate=function(e,o){this.$baseContainer.removeClass("sugar-calendar-block__loading-state"),this.$baseContainer.find(".sugar-calendar-block__base-container__overlay").remove()},SugarCalendarBlocks.Controls.prototype.getDisplayMode=function(){return this.$formContainer.find('input[name="sc_display"]').val()},SugarCalendarBlocks.Controls.prototype.getCalendarIds=function(){let e=[];return this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__cal:checked").each(function(){e.push(jQuery(this).val())}),e},SugarCalendarBlocks.Controls.prototype.getVenueIds=function(){let e=[];return this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__venue:checked").each(function(){e.push(jQuery(this).val())}),e},SugarCalendarBlocks.Controls.prototype.getCalendarsFilter=function(){var e=this.$formContainer.find('input[name="sc_calendars_filter"]');return e.length<=0||(e=e.val()).length<=0?[]:e.split(",")},SugarCalendarBlocks.Controls.prototype.getVenuesFilter=function(){var e=this.$formContainer.find('input[name="sc_venues_filter"]');return e.length<=0||(e=e.val()).length<=0?[]:e.split(",")},SugarCalendarBlocks.Controls.prototype.onChangeDisplay=function(e){var e=jQuery(e.target),o=e.text().trim(),e=e.data("mode");e!==this.getDisplayMode()&&(this.$formContainer.find('input[name="sc_display"]').val(e),this.$blockContainer.find(".sugar-calendar-block__controls__right__view__btn span").text(o),this.update({update_display:!0}))},SugarCalendarBlocks.Controls.prototype.update=function(e){this.$blockContainer.trigger("block:preupdate",[e]),this.$blockContainer.trigger("block:update",[e]),this.$blockContainer.trigger("block:postupdate",[e])},SugarCalendarBlocks.Controls.prototype.goToPrevious=function(){this.update({action:"previous_week"})},SugarCalendarBlocks.Controls.prototype.goToNext=function(){this.update({action:"next_week"})},SugarCalendarBlocks.Controls.prototype.goToCurrent=function(){var e=this.$blockContainer.data();this.$formContainer.find('input[name="sc_year"]').val(e.ogyear),this.$formContainer.find('input[name="sc_month"]').val(e.ogmonth),this.$formContainer.find('input[name="sc_day"]').val(e.ogday),this.update({})},SugarCalendarBlocks.Controls.prototype.onSelectCalendar=function(){this.update({})},SugarCalendarBlocks.Controls.prototype.onSelectVenue=function(){this.update({})},SugarCalendarBlocks.Controls.prototype.getSpeakerIds=function(){var e=this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__speaker:checked");return e.length<=0?[]:e.map(function(){return this.value}).get()},SugarCalendarBlocks.Controls.prototype.getSpeakersFilter=function(){var e=this.$formContainer.find('input[name="sc_speakers_filter"]');return e.length<=0||(e=e.val()).length<=0?[]:e.split(",")},SugarCalendarBlocks.Controls.prototype.onSelectSpeaker=function(){this.update({})},SugarCalendarBlocks.Controls.prototype.onSearch=function(e){13===e.keyCode?this.update({}):0<e.target.value.length?this.$searchClear.show():this.$searchClear.hide()},SugarCalendarBlocks.Controls.prototype.getTagIds=function(){var e=this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__tag:checked");return e.length<=0?[]:e.map(function(){return this.value}).get()},SugarCalendarBlocks.Controls.prototype.getTagsFilter=function(){var e=this.$formContainer.find('input[name="sc_tags_filter"]');return e.length<=0||(e=e.val()).length<=0?[]:e.split(",")},SugarCalendarBlocks.Controls.prototype.onSelectTag=function(){this.update({})},SugarCalendarBlocks.Controls.prototype.onSearchFieldFocus=function(e){jQuery(e.target).parent(".sugar-calendar-block__controls__right__search").addClass("sugar-calendar-block__controls__right__search--active")},SugarCalendarBlocks.Controls.prototype.onSearchFieldFocusOut=function(e){jQuery(e.target).parent(".sugar-calendar-block__controls__right__search").removeClass("sugar-calendar-block__controls__right__search--active")},SugarCalendarBlocks.Controls.prototype.onSearchClick=function(e){this.update({})},SugarCalendarBlocks.Controls.prototype.onClearSearch=function(e){this.$searchContainer.val(""),this.$searchClear.hide(),this.update({})},SugarCalendarBlocks.Controls.prototype.filterDisplayedEvents=function(){this.$blockContainer.trigger("block:filterDisplayedEvents",[{}])},SugarCalendarBlocks.Controls.prototype.initDatePicker=function(){void 0!==this.$datePicker&&this.$datePicker.scbootdatepicker("destroy"),this.$datePicker.scbootdatepicker({minViewMode:0,maxViewMode:2,templates:{leftArrow:'<svg width="6" height="11" viewBox="0 0 6 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.41406 10.6094C5.29688 10.7266 5.13281 10.7266 5.01562 10.6094L0.09375 5.71094C0 5.59375 0 5.42969 0.09375 5.3125L5.01562 0.414062C5.13281 0.296875 5.29688 0.296875 5.41406 0.414062L5.88281 0.859375C5.97656 0.976562 5.97656 1.16406 5.88281 1.25781L1.64062 5.5L5.88281 9.76562C5.97656 9.85938 5.97656 10.0469 5.88281 10.1641L5.41406 10.6094Z" fill="currentColor"/></svg>',rightArrow:'<svg width="6" height="11" viewBox="0 0 6 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.5625 0.414062C0.679688 0.296875 0.84375 0.296875 0.960938 0.414062L5.88281 5.3125C5.97656 5.42969 5.97656 5.59375 5.88281 5.71094L0.960938 10.6094C0.84375 10.7266 0.679688 10.7266 0.5625 10.6094L0.09375 10.1641C0 10.0469 0 9.85938 0.09375 9.76562L4.33594 5.5L0.09375 1.25781C0 1.16406 0 0.976562 0.09375 0.859375L0.5625 0.414062Z" fill="currentColor"/></svg>'},weekStart:sc_frontend_blocks_common_obj.settings.sow,language:sc_frontend_blocks_common_obj.settings.locale});let o=this.$formContainer.find('input[name="sc_year"]'),t=this.$formContainer.find('input[name="sc_month"]'),n=this.$formContainer.find('input[name="sc_day"]'),r=this;this.$datePicker.scbootdatepicker("update",new Date(o.val(),t.val()-1,n.val())),this.$datePicker.on("changeDate",e=>{o.val(e.date.getFullYear()),t.val(e.date.getMonth()+1),n.val(e.date.getDate()),r.update({})})},SugarCalendarBlocks.Controls.prototype.updateDate=function(e){this.$formContainer.find('input[name="sc_year"]').val(e.year),this.$formContainer.find('input[name="sc_month"]').val(e.month),this.$formContainer.find('input[name="sc_day"]').val(e.day),this.$datePicker.scbootdatepicker("update",new Date(e.year,e.month-1,e.day))},SugarCalendarBlocks.Controls.prototype.getTimeOfDay=function(){return this.$timeOfDayContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__time:checked").map((e,o)=>o.value).get()},SugarCalendarBlocks.Controls.prototype.getDaysOfWeek=function(){return this.$daysOfWeekContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__day:checked").map((e,o)=>o.value).get()},SugarCalendarBlocks.Controls.Popovers=SugarCalendarBlocks.Controls.Popovers||function(e){this.controls=e,this.$blockContainer=this.controls.$blockContainer,this.selector={popoverCalendarSelector:".sugar-calendar-block__popover__calendar_selector",popoverCalendarSelectorContainer:".sugar-calendar-block__popover__calendar_selector__container",buttonRightSettingsBtn:".sugar-calendar-block__controls__right__settings__btn",popoverCalendarSelectorHeading:".sugar-calendar-block__popover__calendar_selector__container__heading",popoverCalendarSelectorOptions:".sugar-calendar-block__popover__calendar_selector__container__options",popoverCalendarSelectorApply:".sc-filters-apply",popoverCalendarSelectorClear:".sc-filters-clear",popoverSelectedIndicator:".sc-filter-applied-indicator"};let t=[{key:"month_selector",popover_selector:".sugar-calendar-block__popover__month_selector",button_selector:".sugar-calendar-block__controls__left__date"},{key:"calendar_selector",popover_selector:this.selector.popoverCalendarSelector,button_selector:this.selector.buttonRightSettingsBtn},{key:"display_selector",popover_selector:".sugar-calendar-block__popover__display_selector",button_selector:".sugar-calendar-block__controls__right__view__btn"}];const n=this;t.forEach(e=>{var o=n.$blockContainer.find(e.button_selector);o.on("click",n.toggle.bind(n,o,e.key,t))}),this.initFilterUI(),n.$blockContainer.find(n.selector.popoverCalendarSelectorApply).off("click.sc").on("click.sc",function(){n.onApplyFilters()}),n.$blockContainer.find(n.selector.popoverCalendarSelectorClear).off("click.sc").on("click.sc",function(){n.onClearAllFilters()})},SugarCalendarBlocks.Controls.Popovers.prototype.toggle=function(e,o,t){t=t.find(e=>e.key===o),t=this.$blockContainer.find(t.popover_selector);SugarCalendarBlocks.hideAllPopovers(),t.is(":visible")||this.show(e,t,o)},SugarCalendarBlocks.Controls.Popovers.prototype.show=function(e,t,o){var n=window.innerWidth<768,r=[FloatingUIDOM.offset(10),FloatingUIDOM.shift()];n?e[0].scrollIntoView({behavior:"smooth"}):r.push(FloatingUIDOM.flip()),FloatingUIDOM.computePosition(e[0],t[0],{placement:"calendar_selector"===o?"bottom-end":"bottom-start",middleware:r}).then(({x:e,y:o})=>{Object.assign(t[0].style,{left:e+"px",top:o+"px"})}),e.addClass("sugar-calendar-block__controls__settings__btn_active"),t.show(),this.$blockContainer.parents("body").addClass("sugar-calendar-block__popovers__active")},SugarCalendarBlocks.Controls.Popovers.prototype.initFilterUI=function(){var e=this.controls.$blockContainer.find(this.selector.popoverCalendarSelector).find(this.selector.popoverCalendarSelectorContainer);const r=this;if(!(e.length<=0)){var o,t=this.controls.$blockContainer.find(this.selector.buttonRightSettingsBtn);0<t.length&&(t.addClass("sc-has-indicator"),0===t.find(r.selector.popoverSelectedIndicator).length)&&(o=r.selector.popoverSelectedIndicator.replace(".",""),(o=jQuery(`<span class="${o}" aria-hidden="true"></span>`)).hide(),t.append(o));const a=e.children().filter(function(){return 0<jQuery(this).find(r.selector.popoverCalendarSelectorHeading).length});a.each(function(e){var o=jQuery(this),t=o.find(r.selector.popoverCalendarSelectorOptions).first(),n="true"===o.attr("data-sc-accordion-open");t.toggle(n),o.on("click",function(e){const t=jQuery(this),n="true"===t.attr("data-sc-accordion-open");n&&!jQuery(e.target).hasClass(r.selector.popoverCalendarSelectorHeading.replace(".",""))||a.each(function(){var e=jQuery(this),o=e.find(r.selector.popoverCalendarSelectorOptions).first();!e.is(t)||n?(o.stop(!0,!0).slideUp(150),e.attr("data-sc-accordion-open","false")):(o.stop(!0,!0).slideDown(150),e.attr("data-sc-accordion-open","true"))})})}),a.find('input[type="checkbox"]').on("change",this.updateSectionIndicator.bind(this)),this.updateIndicators()}},SugarCalendarBlocks.Controls.Popovers.prototype.onApplyFilters=function(){this.updateIndicators(),this.controls.update({})},SugarCalendarBlocks.Controls.Popovers.prototype.onClearAllFilters=function(){this.controls.$blockContainer.find(this.selector.popoverCalendarSelector).find('input[type="checkbox"]').prop("checked",!1),this.updateIndicators(),this.updateSectionIndicator(),this.controls.update({})},SugarCalendarBlocks.Controls.Popovers.prototype.updateSectionIndicator=function(){const n=this;this.controls.$blockContainer.find(this.selector.popoverCalendarSelectorHeading).each(function(e,o){var t=0<jQuery(o).parent().find('input[type="checkbox"]').filter(":checked").length;jQuery(o).find(n.selector.popoverSelectedIndicator).css("visibility",t?"visible":"hidden")})},SugarCalendarBlocks.Controls.Popovers.prototype.updateIndicators=function(){var e=this.controls.$blockContainer.find(this.selector.popoverCalendarSelector).find(this.selector.popoverCalendarSelectorContainer);const o=this;e=e.children().filter(function(){return 0<jQuery(this).find(o.selector.popoverCalendarSelectorHeading).length});let t=!1;e.each(function(){0<jQuery(this).find(o.selector.popoverCalendarSelectorOptions).first().find('input[type="checkbox"]').filter(":checked").length&&(t=!0)}),this.controls.$blockContainer.find(this.selector.buttonRightSettingsBtn).find(this.selector.popoverSelectedIndicator).css("display",t?"block":"none")};