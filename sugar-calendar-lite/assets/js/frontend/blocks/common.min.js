var SugarCalendarBlocks=window.SugarCalendarBlocks||(e=>{let t={init(){e(t.ready)},ready(){t.setupDatepickerI18n(),e("body").on("click",t.events.closePopoversOnBodyClick)},events:{closePopoversOnBodyClick(o){!e(this).hasClass("sugar-calendar-block__popovers__active")||(o=e(o.target)).hasClass("sugar-calendar-block__controls__left__date")||o.hasClass("sugar-calendar-block__controls__right__settings__btn")||o.hasClass("sugar-calendar-block__controls__right__view__btn")||o.hasClass("sugar-calendar-block__event-cell")||o.hasClass("sugar-calendar-block__popover")||0<o.parents(".sugar-calendar-block__controls__left__date").length||0<o.parents(".sugar-calendar-block__controls__right__settings__btn").length||0<o.parents(".sugar-calendar-block__controls__right__view__btn").length||0<o.parents(".sugar-calendar-block__event-cell").length||0<o.parents(".sugar-calendar-block__popover").length||t.hideAllPopovers()}},hideAllPopovers(){var o=e("body");o.find(".sugar-calendar-block__popover").removeClass("sugar-calendar-block__controls__settings__btn_active").hide(),o.find(".sugar-calendar-block__controls__settings__btn").removeClass("sugar-calendar-block__controls__settings__btn_active"),o.find(".sugar-calendar-block__controls__left__date").removeClass("sugar-calendar-block__controls__settings__btn_active"),o.removeClass("sugar-calendar-block__popovers__active")},setupDatepickerI18n(){var o=sc_frontend_blocks_common_obj.settings.locale;e.fn.scbootdatepicker.dates[o]={days:sc_frontend_blocks_common_obj.settings.i18n.days,daysShort:sc_frontend_blocks_common_obj.settings.i18n.daysShort,daysMin:sc_frontend_blocks_common_obj.settings.i18n.daysMin,months:sc_frontend_blocks_common_obj.settings.i18n.months,monthsShort:sc_frontend_blocks_common_obj.settings.i18n.monthsShort}}};return t})((document,window,jQuery));SugarCalendarBlocks.init(),SugarCalendarBlocks.Controls=SugarCalendarBlocks.Controls||function(o){this.$blockContainer=o,this.$baseContainer=o.find(".sugar-calendar-block__base-container"),this.$datePicker=o.find(".sugar-calendar-block__controls__datepicker"),this.$formContainer=o.find(".sugar-calendar-block-settings"),this.$searchContainer=o.find(".sugar-calendar-block__controls__right__search__field"),this.$searchClear=o.find(".sugar-calendar-block__controls__right__search__clear"),this.$timeOfDayContainer=o.find(".sugar-calendar-block__popover__calendar_selector__container__time"),this.$daysOfWeekContainer=o.find(".sugar-calendar-block__popover__calendar_selector__container__days"),this.initDatePicker(),this.$blockContainer.find(".sugar-calendar-block__popover__display_selector__container__body__option").on("click",this.onChangeDisplay.bind(this)),this.$blockContainer.find(".sugar-calendar-block__controls__left__pagination__prev").on("click",this.goToPrevious.bind(this)),this.$blockContainer.find(".sugar-calendar-block__controls__left__pagination__next").on("click",this.goToNext.bind(this)),this.$blockContainer.find(".sugar-calendar-block__controls__left__pagination__current").on("click",this.goToCurrent.bind(this)),this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__cal").on("click",this.onSelectCalendar.bind(this)),this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__venue").on("click",this.onSelectVenue.bind(this)),this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__speaker").on("click",this.onSelectSpeaker.bind(this)),this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__tag").on("click",this.onSelectTag.bind(this)),this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__day").on("change",this.filterDisplayedEvents.bind(this)),this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__time").on("change",this.filterDisplayedEvents.bind(this)),this.$searchContainer.on("keyup",this.onSearch.bind(this)),this.$searchContainer.on("focus",this.onSearchFieldFocus.bind(this)),this.$searchContainer.on("focusout",this.onSearchFieldFocusOut.bind(this)),this.$blockContainer.find(".sugar-calendar-block__controls__right__search__icon").on("click",this.onSearchClick.bind(this)),this.$searchClear.on("click",this.onClearSearch.bind(this)),new SugarCalendarBlocks.Controls.Popovers(o),this.$blockContainer.on("block:preupdate",this.onPreUpdate.bind(this)),this.$blockContainer.on("block:postupdate",this.onPostUpdate.bind(this))},SugarCalendarBlocks.Controls.prototype.onPreUpdate=function(o,e){this.$baseContainer.addClass("sugar-calendar-block__loading-state"),this.$baseContainer.prepend('<div class="sugar-calendar-block__base-container__overlay"><div class="sugar-calendar-block__loading"></div></div>')},SugarCalendarBlocks.Controls.prototype.onPostUpdate=function(o,e){this.$baseContainer.removeClass("sugar-calendar-block__loading-state"),this.$baseContainer.find(".sugar-calendar-block__base-container__overlay").remove()},SugarCalendarBlocks.Controls.prototype.getDisplayMode=function(){return this.$formContainer.find('input[name="sc_display"]').val()},SugarCalendarBlocks.Controls.prototype.getCalendarIds=function(){let o=[];return this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__cal:checked").each(function(){o.push(jQuery(this).val())}),o},SugarCalendarBlocks.Controls.prototype.getVenueIds=function(){let o=[];return this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__venue:checked").each(function(){o.push(jQuery(this).val())}),o},SugarCalendarBlocks.Controls.prototype.getCalendarsFilter=function(){var o=this.$formContainer.find('input[name="sc_calendars_filter"]');return o.length<=0||(o=o.val()).length<=0?[]:o.split(",")},SugarCalendarBlocks.Controls.prototype.getVenuesFilter=function(){var o=this.$formContainer.find('input[name="sc_venues_filter"]');return o.length<=0||(o=o.val()).length<=0?[]:o.split(",")},SugarCalendarBlocks.Controls.prototype.onChangeDisplay=function(o){var o=jQuery(o.target),e=o.text().trim(),o=o.data("mode");o!==this.getDisplayMode()&&(this.$formContainer.find('input[name="sc_display"]').val(o),this.$blockContainer.find(".sugar-calendar-block__controls__right__view__btn span").text(e),this.update({update_display:!0}))},SugarCalendarBlocks.Controls.prototype.update=function(o){this.$blockContainer.trigger("block:preupdate",[o]),this.$blockContainer.trigger("block:update",[o]),this.$blockContainer.trigger("block:postupdate",[o])},SugarCalendarBlocks.Controls.prototype.goToPrevious=function(){this.update({action:"previous_week"})},SugarCalendarBlocks.Controls.prototype.goToNext=function(){this.update({action:"next_week"})},SugarCalendarBlocks.Controls.prototype.goToCurrent=function(){var o=this.$blockContainer.data();this.$formContainer.find('input[name="sc_year"]').val(o.ogyear),this.$formContainer.find('input[name="sc_month"]').val(o.ogmonth),this.$formContainer.find('input[name="sc_day"]').val(o.ogday),this.update({})},SugarCalendarBlocks.Controls.prototype.onSelectCalendar=function(){this.update({})},SugarCalendarBlocks.Controls.prototype.onSelectVenue=function(){this.update({})},SugarCalendarBlocks.Controls.prototype.getSpeakerIds=function(){var o=this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__speaker:checked");return o.length<=0?[]:o.map(function(){return this.value}).get()},SugarCalendarBlocks.Controls.prototype.getSpeakersFilter=function(){var o=this.$formContainer.find('input[name="sc_speakers_filter"]');return o.length<=0||(o=o.val()).length<=0?[]:o.split(",")},SugarCalendarBlocks.Controls.prototype.onSelectSpeaker=function(){this.update({})},SugarCalendarBlocks.Controls.prototype.onSearch=function(o){13===o.keyCode?this.update({}):0<o.target.value.length?this.$searchClear.show():this.$searchClear.hide()},SugarCalendarBlocks.Controls.prototype.getTagIds=function(){var o=this.$blockContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__tag:checked");return o.length<=0?[]:o.map(function(){return this.value}).get()},SugarCalendarBlocks.Controls.prototype.getTagsFilter=function(){var o=this.$formContainer.find('input[name="sc_tags_filter"]');return o.length<=0||(o=o.val()).length<=0?[]:o.split(",")},SugarCalendarBlocks.Controls.prototype.onSelectTag=function(){this.update({})},SugarCalendarBlocks.Controls.prototype.onSearchFieldFocus=function(o){jQuery(o.target).parent(".sugar-calendar-block__controls__right__search").addClass("sugar-calendar-block__controls__right__search--active")},SugarCalendarBlocks.Controls.prototype.onSearchFieldFocusOut=function(o){jQuery(o.target).parent(".sugar-calendar-block__controls__right__search").removeClass("sugar-calendar-block__controls__right__search--active")},SugarCalendarBlocks.Controls.prototype.onSearchClick=function(o){this.update({})},SugarCalendarBlocks.Controls.prototype.onClearSearch=function(o){this.$searchContainer.val(""),this.$searchClear.hide(),this.update({})},SugarCalendarBlocks.Controls.prototype.filterDisplayedEvents=function(){this.$blockContainer.trigger("block:filterDisplayedEvents",[{}])},SugarCalendarBlocks.Controls.prototype.initDatePicker=function(){void 0!==this.$datePicker&&this.$datePicker.scbootdatepicker("destroy"),this.$datePicker.scbootdatepicker({minViewMode:0,maxViewMode:2,templates:{leftArrow:'<svg width="6" height="11" viewBox="0 0 6 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.41406 10.6094C5.29688 10.7266 5.13281 10.7266 5.01562 10.6094L0.09375 5.71094C0 5.59375 0 5.42969 0.09375 5.3125L5.01562 0.414062C5.13281 0.296875 5.29688 0.296875 5.41406 0.414062L5.88281 0.859375C5.97656 0.976562 5.97656 1.16406 5.88281 1.25781L1.64062 5.5L5.88281 9.76562C5.97656 9.85938 5.97656 10.0469 5.88281 10.1641L5.41406 10.6094Z" fill="currentColor"/></svg>',rightArrow:'<svg width="6" height="11" viewBox="0 0 6 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.5625 0.414062C0.679688 0.296875 0.84375 0.296875 0.960938 0.414062L5.88281 5.3125C5.97656 5.42969 5.97656 5.59375 5.88281 5.71094L0.960938 10.6094C0.84375 10.7266 0.679688 10.7266 0.5625 10.6094L0.09375 10.1641C0 10.0469 0 9.85938 0.09375 9.76562L4.33594 5.5L0.09375 1.25781C0 1.16406 0 0.976562 0.09375 0.859375L0.5625 0.414062Z" fill="currentColor"/></svg>'},weekStart:sc_frontend_blocks_common_obj.settings.sow,language:sc_frontend_blocks_common_obj.settings.locale});let e=this.$formContainer.find('input[name="sc_year"]'),t=this.$formContainer.find('input[name="sc_month"]'),n=this.$formContainer.find('input[name="sc_day"]'),a=this;this.$datePicker.scbootdatepicker("update",new Date(e.val(),t.val()-1,n.val())),this.$datePicker.on("changeDate",o=>{e.val(o.date.getFullYear()),t.val(o.date.getMonth()+1),n.val(o.date.getDate()),a.update({})})},SugarCalendarBlocks.Controls.prototype.updateDate=function(o){this.$formContainer.find('input[name="sc_year"]').val(o.year),this.$formContainer.find('input[name="sc_month"]').val(o.month),this.$formContainer.find('input[name="sc_day"]').val(o.day),this.$datePicker.scbootdatepicker("update",new Date(o.year,o.month-1,o.day))},SugarCalendarBlocks.Controls.prototype.getTimeOfDay=function(){return this.$timeOfDayContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__time:checked").map((o,e)=>e.value).get()},SugarCalendarBlocks.Controls.prototype.getDaysOfWeek=function(){return this.$daysOfWeekContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__day:checked").map((o,e)=>e.value).get()},SugarCalendarBlocks.Controls.Popovers=SugarCalendarBlocks.Controls.Popovers||function(o){this.$blockContainer=o;let t=[{key:"month_selector",popover_selector:".sugar-calendar-block__popover__month_selector",button_selector:".sugar-calendar-block__controls__left__date"},{key:"calendar_selector",popover_selector:".sugar-calendar-block__popover__calendar_selector",button_selector:".sugar-calendar-block__controls__right__settings__btn"},{key:"display_selector",popover_selector:".sugar-calendar-block__popover__display_selector",button_selector:".sugar-calendar-block__controls__right__view__btn"}],n=this;t.forEach(o=>{var e=this.$blockContainer.find(o.button_selector);e.on("click",n.toggle.bind(n,e,o.key,t))})},SugarCalendarBlocks.Controls.Popovers.prototype.toggle=function(o,e,t){t=t.find(o=>o.key===e),t=this.$blockContainer.find(t.popover_selector);SugarCalendarBlocks.hideAllPopovers(),t.is(":visible")||this.show(o,t,e)},SugarCalendarBlocks.Controls.Popovers.prototype.show=function(o,t,e){var n=window.innerWidth<768,a=[FloatingUIDOM.offset(10),FloatingUIDOM.shift()];n?o[0].scrollIntoView({behavior:"smooth"}):a.push(FloatingUIDOM.flip()),FloatingUIDOM.computePosition(o[0],t[0],{placement:"calendar_selector"===e?"bottom-end":"bottom-start",middleware:a}).then(({x:o,y:e})=>{Object.assign(t[0].style,{left:o+"px",top:e+"px"})}),o.addClass("sugar-calendar-block__controls__settings__btn_active"),t.show(),this.$blockContainer.parents("body").addClass("sugar-calendar-block__popovers__active")};