!function(e){"use strict";var t=window.SugarCalendar||{};t.Admin=t.Admin||{},t.Admin.Event={localizedScripts:{},init:function(){this.$clearCalendarButton=e("#sc_event_category-clear"),this.$calendarListRadios=e("#sc_event_categorychecklist input"),this.$eventSubmitButton=e("body.wp-admin.sugar-calendar #publish"),this.$eventSaveDraftButton=e("body.wp-admin.sugar-calendar #save-post"),this.$eventPreviewButton=e("body.wp-admin.sugar-calendar #post-preview"),this.$eventTitle=e("body.wp-admin.sugar-calendar #title"),this.getLocalizedScripts(),this.bindEvents(),this.manipulateElements(),"object"==typeof wp.blockEditor&&this.blockEditorCustomValidation()},getLocalizedScripts:function(){this.localizedScripts="undefined"!=typeof sugar_calendar_admin_event_vars?sugar_calendar_admin_event_vars:{},void 0===this.localizedScripts?.notice_title_required&&(this.localizedScripts.notice_title_required="Event title is required")},bindEvents:function(){this.$clearCalendarButton.on("click",this.clearCalendar.bind(this)),this.$eventTitle.on("input propertychange",this.toggleActivatePublishGroupButtons.bind(this)),this.$eventTitle.on("input propertychange",this.toggleAlertTitleEmpty.bind(this)),this.$eventSubmitButton.on("mouseenter",this.toggleAlertTitleEmpty.bind(this)),this.$eventSaveDraftButton.on("mouseenter",this.toggleAlertTitleEmpty.bind(this)),this.$eventPreviewButton.on("mouseenter",this.toggleAlertTitleEmpty.bind(this)),this.$eventPreviewButton.on("click",this.preventPreviewButtonClick.bind(this))},manipulateElements:function(){this.toggleActivatePublishGroupButtons()},clearCalendar:function(t){t.preventDefault(),this.$calendarListRadios.removeAttr("checked")},toggleAlertTitleEmpty:function(){var t=""===this.$eventTitle.val();t?(this.$eventSubmitButton.attr("title",this.localizedScripts.notice_title_required),this.showTitleRequiredInline()):(this.$eventSubmitButton.removeAttr("title"),this.hideTitleRequiredInline()),this.$eventTitle.toggleClass("sugar-calendar-field-title-empty",t)},showTitleRequiredInline:function(){var t;0<e("#sugar-calendar-title-required-inline").length||(t='<p id="sugar-calendar-title-required-inline" class="sugar-calendar-inline-error">'+this.localizedScripts.notice_title_required+"</p>",e("#title").after(t))},hideTitleRequiredInline:function(){e("#sugar-calendar-title-required-inline").remove()},toggleActivatePublishGroupButtons:function(){""===this.$eventTitle.val()?(this.$eventSubmitButton.attr("disabled",!0),this.$eventSaveDraftButton.attr("disabled",!0),this.$eventPreviewButton.attr("disabled",!0)):(this.$eventSubmitButton.removeAttr("disabled"),this.$eventSaveDraftButton.removeAttr("disabled"),this.$eventPreviewButton.removeAttr("disabled"))},preventPreviewButtonClick:function(t){""===this.$eventTitle.val()&&(t.preventDefault(),t.stopImmediatePropagation())},blockEditorCustomValidation:function(){var t=this.localizedScripts.notice_title_required;this.localizedScripts.supports_editor_pre_save?this.useFilterApproach(t):this.useLegacyApproach(t)},useFilterApproach:function(r){wp.hooks.addFilter("editor.preSavePost","sugar-calendar/validate-event-title",function(t,e){var i=wp.data.select("core/editor").getEditedPostAttribute("title");if(""!==i&&i&&""!==i.trim())return t;{const n=wp.data.subscribe(()=>{var t=wp.data.select("core/editor").getEditedPostAttribute("title");t&&""!==t.trim()&&(n(),wp.data.dispatch("core/notices").removeNotice("editor-save"))})}throw new Error(r)})},useLegacyApproach:function(e){let i=!1,n=!1;wp.data.subscribe(()=>{let t=!1;"function"==typeof wp.data.select("core/edit-post").isPublishSidebarOpened?t=wp.data.select("core/edit-post").isPublishSidebarOpened():"object"==typeof wp.data.select("core/editor").isPublishSidebarOpened&&(t=wp.data.select("core/editor").isPublishSidebarOpened()),""===wp.data.select("core/editor").getEditedPostAttribute("title")?(i||(i=!0,wp.data.dispatch("core/editor").lockPostSaving("save-lock-title")),n||(n=!0,wp.data.dispatch("core/notices").createNotice("error",e,{id:"save-lock-title",isDismissible:!0}))):(i&&(i=!1,wp.data.dispatch("core/editor").unlockPostSaving("save-lock-title")),n&&(n=!1,wp.data.dispatch("core/notices").removeNotice("save-lock-title")))})}},t.Admin.Event.init(),window.SugarCalendar=t}(jQuery);