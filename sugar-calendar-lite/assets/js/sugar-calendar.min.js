"use strict";var sugar_calendar=window.sugar_calendar||function(r,_){function d(e){e.find(".sugar-calendar-block__popover").removeClass("sugar-calendar-block__controls__settings__btn_active").hide(),e.find(".sugar-calendar-block__controls__settings__btn").removeClass("sugar-calendar-block__controls__settings__btn_active"),e.find(".sugar-calendar-block__controls__left__date").removeClass("sugar-calendar-block__controls__settings__btn_active"),_("body").removeClass("sugar-calendar-block__popovers__active")}function a(e,a){this.$popover=e,this.$mainContainer=a}function n(e){this.calendarBlock=e,this.$mainContainer=e.$mainContainer,this.selector={popoverCalendarSelector:".sugar-calendar-block__popover__calendar_selector",popoverCalendarSelectorContainer:".sugar-calendar-block__popover__calendar_selector__container",buttonRightSettingsBtn:".sugar-calendar-block__controls__right__settings__btn",popoverCalendarSelectorHeading:".sugar-calendar-block__popover__calendar_selector__container__heading",popoverCalendarSelectorOptions:".sugar-calendar-block__popover__calendar_selector__container__options",popoverCalendarSelectorApply:".sc-filters-apply",popoverCalendarSelectorClear:".sc-filters-clear",popoverSelectedIndicator:".sc-filter-applied-indicator"};let t=[{key:"month_selector",popover_selector:".sugar-calendar-block__popover__month_selector",button_selector:".sugar-calendar-block__controls__left__date"},{key:"calendar_selector",popover_selector:this.selector.popoverCalendarSelector,button_selector:this.selector.buttonRightSettingsBtn},{key:"display_selector",popover_selector:".sugar-calendar-block__popover__display_selector",button_selector:".sugar-calendar-block__controls__right__view__btn"}],n=this;t.forEach(e=>{var a=n.$mainContainer.find(e.button_selector);a.on("click",n.toggle.bind(n,a,e.key,t))}),this.initFilterUI(),this.$mainContainer.find(this.selector.popoverCalendarSelectorApply).off("click.sc").on("click.sc",this.onApplyFilters.bind(this)),this.$mainContainer.find(this.selector.popoverCalendarSelectorClear).off("click.sc").on("click.sc",this.onClearAllFilters.bind(this))}function e(e){this.calendarBlock=e}function t(e){this.$mainContainer=e,this.$formContainer=e.find(".sugar-calendar-block-settings"),this.$mobileListContainer=e.find(".sugar-calendar-block__mobile_event_list"),this.id=this.$formContainer.find('input[name="sc_calendar_id"]').val(),this.$searchContainer=e.find(".sugar-calendar-block__controls__right__search__field"),this.$searchClear=e.find(".sugar-calendar-block__controls__right__search__clear"),this.$timeOfDayContainer=e.find(".sugar-calendar-block__popover__calendar_selector__container__time"),this.$daysOfWeekContainer=e.find(".sugar-calendar-block__popover__calendar_selector__container__days"),this.$datePicker=e.find(".sugar-calendar-block__controls__datepicker"),void 0!==this.id&&0<this.id.length&&(this.initPopovers(),this.initControls(),this.initDatePicker()),1===parseInt(this.$formContainer.find('input[name="sc_visitor_tz_convert"]').val())&&this.update()}let h=null,o=(a.prototype.show=function(e){var a=_(e.target);let t;a=(t=a.hasClass("sugar-calendar-block__event-cell")?a:_(e.target).parents(".sugar-calendar-block__event-cell")).data("eventobjid");let n=this.$popover.find(".sugar-calendar-block__popover__event__container__image"),o=this.$popover.find(".sugar-calendar-block__popover__event__container__content__description");n.hide(),n.css("background-image",""),o.text(""),void 0!==a&&(o.prepend('<div class="sugar-calendar-block__loading sugar-calendar-block__loading--no-overlay"></div>'),_.post(sugar_calendar_obj.ajax_url,{action:"sugar_calendar_event_popover",event_object_id:a,nonce:sugar_calendar_obj.nonce},function(e){e.success&&e.data&&(e.data.image&&(n.css("background-image",`url(${e.data.image})`),n.show()),o.html(""),o.html(e.data.description.trim()))}));var e=t.find(".sugar-calendar-block__event-cell__title").text().trim(),a=t.find(".sugar-calendar-block__event-cell__time").text().trim(),r=this.$popover.find(".sugar-calendar-block__popover__event__container__content__title__link");r.attr("href",t.data("eventurl")),r.text(e),1===t.data("openinnewtab")?r.attr("target","_blank"):r.removeAttr("target");let i=Intl.DateTimeFormat().resolvedOptions().timeZone,l="",c=t.data("daydate");"undefined"!=typeof SCTimeZones&&i.length?(l=wp.date.dateI18n(SCTimezoneConvert.date_format,c.start_date.datetime,i),c.end_date&&(l+=" - "+wp.date.dateI18n(SCTimezoneConvert.date_format,c.end_date.datetime,i))):(l=c.start_date.value,c.end_date&&(l+=" - "+c.end_date.value)),this.$popover.find(".sugar-calendar-block__popover__event__container__content__date").text(l),this.$popover.find(".sugar-calendar-block__popover__event__container__content__time").text(a);e=this.$popover.find(".sugar-calendar-block__popover__event__container__content__calendar");e.html("");let s=t.data("calendarsinfo");if(void 0!==s&&void 0!==s.calendars){let a=[];s.calendars.forEach(e=>{a.push(`<div style="border-left: 2px solid ${e.color||s.primary_event_color};" class="sugar-calendar-block__popover__event__container__content__calendar__item">${e.name}</div>`)}),e.html(a.join(""))}h.computePosition(t[0],this.$popover[0],{placement:"bottom-start",middleware:[h.offset(10),h.flip(),h.shift()]}).then(({x:e,y:a})=>{Object.assign(this.$popover[0].style,{left:e+"px",top:a+"px"})}),d(this.$mainContainer),this.$popover.show(),_("body").addClass("sugar-calendar-block__popovers__active")},n.prototype.toggle=function(e,a,t){t=t.find(e=>e.key===a),t=this.$mainContainer.find(t.popover_selector);t.is(":visible")?d(this.$mainContainer):(d(this.$mainContainer),this.show(e,t,a))},n.prototype.show=function(e,t,a){var n=r.innerWidth<768,o=[h.offset(10),h.shift()];n?e[0].scrollIntoView({behavior:"smooth"}):o.push(h.flip()),h.computePosition(e[0],t[0],{placement:"calendar_selector"===a?"bottom-end":"bottom-start",middleware:o}).then(({x:e,y:a})=>{Object.assign(t[0].style,{left:e+"px",top:a+"px"})}),e.addClass("sugar-calendar-block__controls__settings__btn_active"),t.show(),_("body").addClass("sugar-calendar-block__popovers__active")},n.prototype.initFilterUI=function(){var e=this.$mainContainer.find(this.selector.popoverCalendarSelector).find(this.selector.popoverCalendarSelectorContainer);const o=this;if(!(e.length<=0)){var a,t=this.$mainContainer.find(this.selector.buttonRightSettingsBtn);0<t.length&&(t.addClass("sc-has-indicator"),0===t.find(o.selector.popoverSelectedIndicator).length)&&(a=o.selector.popoverSelectedIndicator.replace(".",""),(a=jQuery(`<span class="${a}" aria-hidden="true"></span>`)).hide(),t.append(a));const r=e.children().filter(function(){return 0<jQuery(this).find(o.selector.popoverCalendarSelectorHeading).length});r.each(function(){var e=jQuery(this),a=e.find(o.selector.popoverCalendarSelectorOptions).first(),t="true"===e.attr("data-sc-accordion-open");a.toggle(t),e.on("click",function(e){const t=jQuery(this),n="true"===t.attr("data-sc-accordion-open");n&&!_(e.target).hasClass(o.selector.popoverCalendarSelectorHeading.replace(".",""))||r.each(function(){var e=jQuery(this),a=e.find(o.selector.popoverCalendarSelectorOptions).first();!e.is(t)||n?(a.stop(!0,!0).slideUp(150),e.attr("data-sc-accordion-open","false")):(a.stop(!0,!0).slideDown(150),e.attr("data-sc-accordion-open","true"))})})}),r.find('input[type="checkbox"]').on("change",this.updateSectionIndicator.bind(this)),this.updateIndicators()}},n.prototype.onApplyFilters=function(){this.updateIndicators(),this.calendarBlock.update()},n.prototype.onClearAllFilters=function(){this.$mainContainer.find(this.selector.popoverCalendarSelector).find('input[type="checkbox"]').prop("checked",!1),this.updateIndicators(),this.updateSectionIndicator(),this.calendarBlock.update()},n.prototype.updateSectionIndicator=function(){const n=this;this.$mainContainer.find(this.selector.popoverCalendarSelectorHeading).each(function(e,a){var t=0<jQuery(a).parent().find('input[type="checkbox"]').filter(":checked").length;jQuery(a).find(n.selector.popoverSelectedIndicator).css("visibility",t?"visible":"hidden")})},n.prototype.updateIndicators=function(){var e=this.$mainContainer.find(this.selector.popoverCalendarSelector).find(this.selector.popoverCalendarSelectorContainer);const a=this;e=e.children().filter(function(){return 0<jQuery(this).find(a.selector.popoverCalendarSelectorHeading).length});let t=!1;e.each(function(){0<jQuery(this).find(a.selector.popoverCalendarSelectorOptions).first().find('input[type="checkbox"]').filter(":checked").length&&(t=!0)}),this.$mainContainer.find(this.selector.buttonRightSettingsBtn).find(this.selector.popoverSelectedIndicator).css("display",t?"block":"none")},e.prototype.onSearch=function(e){13===e.keyCode?this.calendarBlock.update():0<e.target.value.length?this.calendarBlock.$searchClear.show():this.calendarBlock.$searchClear.hide()},e.prototype.onSearchClick=function(e){this.calendarBlock.update()},e.prototype.onClearSearch=function(e){this.calendarBlock.$searchContainer.val(""),this.calendarBlock.$searchClear.hide(),this.calendarBlock.update()},e.prototype.goToMonth=function(e){this.calendarBlock.$formContainer.find('input[name="sc_month"]').val(parseInt(e.target.dataset.month)),this.calendarBlock.update()},e.prototype.goToPrevious=function(){switch(this.calendarBlock.getDisplay()){case"day":this.calendarBlock.update(!1,"previous_day");break;case"week":this.calendarBlock.update(!1,"previous_week");break;case"month":this.calendarBlock.update(!1,"previous_month")}},e.prototype.goToNext=function(){switch(this.calendarBlock.getDisplay()){case"day":this.calendarBlock.update(!1,"next_day");break;case"week":this.calendarBlock.update(!1,"next_week");break;case"month":this.calendarBlock.update(!1,"next_month")}},e.prototype.onSelectCalendar=function(){this.calendarBlock.update()},e.prototype.onSelectTag=function(){this.calendarBlock.update()},e.prototype.onSelectVenue=function(){this.calendarBlock.update()},e.prototype.onSelectSpeaker=function(){this.calendarBlock.update()},e.prototype.onSelectCurrent=function(){this.calendarBlock.$formContainer.find('input[name="sc_month"]').val(this.calendarBlock.$mainContainer.data("ogmonth")),this.calendarBlock.$formContainer.find('input[name="sc_year"]').val(this.calendarBlock.$mainContainer.data("ogyear")),this.calendarBlock.$formContainer.find('input[name="sc_day"]').val(this.calendarBlock.$mainContainer.data("ogday")),this.calendarBlock.update()},e.prototype.onChangeDisplay=function(e){var e=_(e.target),a=e.text().trim(),e=e.data("mode");e!==this.calendarBlock.getDisplay()&&(this.calendarBlock.$mainContainer.removeClass(`sugar-calendar-block__${this.calendarBlock.getDisplay()}-view`),this.calendarBlock.$mainContainer.addClass(`sugar-calendar-block__${e}-view`),this.calendarBlock.$formContainer.find('input[name="sc_display"]').val(e),this.calendarBlock.update(!0),this.calendarBlock.$mainContainer.find(".sugar-calendar-block__controls__right__view__btn span").text(a))},t.prototype.initDatePicker=function(){void 0!==this.$datePicker&&this.$datePicker.scbootdatepicker("destroy");let e=0,a=("month"===this.getDisplay()&&(e=1),this.setupDatepickerI18n(),this.$datePicker.scbootdatepicker({minViewMode:e,maxViewMode:2,templates:{leftArrow:'<svg width="6" height="11" viewBox="0 0 6 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M5.41406 10.6094C5.29688 10.7266 5.13281 10.7266 5.01562 10.6094L0.09375 5.71094C0 5.59375 0 5.42969 0.09375 5.3125L5.01562 0.414062C5.13281 0.296875 5.29688 0.296875 5.41406 0.414062L5.88281 0.859375C5.97656 0.976562 5.97656 1.16406 5.88281 1.25781L1.64062 5.5L5.88281 9.76562C5.97656 9.85938 5.97656 10.0469 5.88281 10.1641L5.41406 10.6094Z" fill="currentColor"/></svg>',rightArrow:'<svg width="6" height="11" viewBox="0 0 6 11" fill="none" xmlns="http://www.w3.org/2000/svg"><path d="M0.5625 0.414062C0.679688 0.296875 0.84375 0.296875 0.960938 0.414062L5.88281 5.3125C5.97656 5.42969 5.97656 5.59375 5.88281 5.71094L0.960938 10.6094C0.84375 10.7266 0.679688 10.7266 0.5625 10.6094L0.09375 10.1641C0 10.0469 0 9.85938 0.09375 9.76562L4.33594 5.5L0.09375 1.25781C0 1.16406 0 0.976562 0.09375 0.859375L0.5625 0.414062Z" fill="currentColor"/></svg>'},weekStart:sugar_calendar_obj.settings.sow,language:sugar_calendar_obj.settings.locale}),this.$formContainer.find('input[name="sc_year"]')),t=this.$formContainer.find('input[name="sc_month"]'),n=this.$formContainer.find('input[name="sc_day"]');this.$datePicker.scbootdatepicker("update",new Date(a.val(),t.val()-1,n.val())),this.$datePicker.on("changeDate",e=>{a.val(e.date.getFullYear()),t.val(e.date.getMonth()+1),"month"!==this.getDisplay()&&n.val(e.date.getDate()),this.update()})},t.prototype.initPopovers=function(){let t=this.$mainContainer;new n(this);var e=t.find(".sugar-calendar-block__popover__event"),e=new a(e,t);768<=r.innerWidth?t.on("click",".sugar-calendar-block__event-cell",e.show.bind(e)):t.on("click",".sugar-calendar-block__calendar-week__header__cell",function(e){let a=_(e.target);(a=a.hasClass("sugar-calendar-block__calendar-week__header__cell")?a:a.parents(".sugar-calendar-block__calendar-week__header__cell")).hasClass("sugar-calendar-block__calendar-week__header__cell--active")||void 0===a.data("weekdaynum")||(t.find(".sugar-calendar-block__calendar-week__header__cell--active").removeClass("sugar-calendar-block__calendar-week__header__cell--active"),t.find(".sugar-calendar-block__calendar-week__time-grid__day-col--active").removeClass("sugar-calendar-block__calendar-week__time-grid__day-col--active"),t.find(".sugar-calendar-block__calendar-week__event-slot--all-day--active").removeClass("sugar-calendar-block__calendar-week__event-slot--all-day--active"),a.addClass("sugar-calendar-block__calendar-week__header__cell--active"),t.find(".sugar-calendar-block__calendar-week__event-slot--all-day--"+a.data("weekdaynum")).addClass("sugar-calendar-block__calendar-week__event-slot--all-day--active"),t.find(".sugar-calendar-block__calendar-week__time-grid__day-col-"+a.data("weekdaynum")).addClass("sugar-calendar-block__calendar-week__time-grid__day-col--active"))})},t.prototype.initControls=function(){this.controlEvents=new e(this),this.$searchContainer.on("keyup",this.controlEvents.onSearch.bind(this.controlEvents)),this.$searchClear.on("click",this.controlEvents.onClearSearch.bind(this.controlEvents)),this.$mainContainer.find(".sugar-calendar-block__controls__right__search__icon").on("click",this.controlEvents.onSearchClick.bind(this.controlEvents)),this.$mainContainer.find(".sugar-calendar-block__popover__month_selector__container__body__month").on("click",this.controlEvents.goToMonth.bind(this.controlEvents)),this.$mainContainer.find(".sugar-calendar-block__controls__left__pagination__prev").on("click",this.controlEvents.goToPrevious.bind(this.controlEvents)),this.$mainContainer.find(".sugar-calendar-block__controls__left__pagination__next").on("click",this.controlEvents.goToNext.bind(this.controlEvents)),this.$mainContainer.find(".sugar-calendar-block__controls__left__pagination__current").on("click",this.controlEvents.onSelectCurrent.bind(this.controlEvents)),this.$mainContainer.find(".sugar-calendar-block__popover__display_selector__container__body__option").on("click",this.controlEvents.onChangeDisplay.bind(this.controlEvents)),r.innerWidth<768&&(this.$mainContainer.on("click",".sugar-calendar-block__calendar-month__body__day",this.showMobileEvents.bind(this)),this.$mainContainer.on("click",".sugar-calendar-block__mobile_event_list .sugar-calendar-block__event-cell",this.onMobileEventCellClicked.bind(this)),this.$mainContainer.on("click",".sugar-calendar-block__calendar-week__event-slot .sugar-calendar-block__event-cell",this.onMobileEventCellClicked.bind(this)),this.$mainContainer.on("click",".sugar-calendar-block__calendar-day .sugar-calendar-block__event-cell",this.onMobileEventCellClicked.bind(this)))},t.prototype.onMobileEventCellClicked=function(e){let a=_(e.target);(a=a.hasClass("sugar-calendar-block__event-cell")?a:a.parents(".sugar-calendar-block__event-cell")).data("eventurl")&&(r.location.href=a.data("eventurl"))},t.prototype.getCalendarIds=function(){let e=[];return this.$mainContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__cal:checked").each(function(){e.push(_(this).val())}),e},t.prototype.getVenuesIds=function(){let e=[];return this.$mainContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__venue:checked").each(function(){e.push(_(this).val())}),e},t.prototype.getSpeakerIds=function(){let e=[];return this.$mainContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__speaker:checked").each(function(){e.push(_(this).val())}),e},t.prototype.getCalendarsFilter=function(){var e=this.$formContainer.find('input[name="sc_calendars_filter"]');return e.length<=0||(e=e.val()).length<=0?[]:e.split(",")},t.prototype.getVenuesFilter=function(){var e=this.$formContainer.find('input[name="sc_venues_filter"]');return e.length<=0||(e=e.val()).length<=0?[]:e.split(",")},t.prototype.getSpeakersFilter=function(){var e=this.$formContainer.find('input[name="sc_speakers_filter"]');return e.length<=0||(e=e.val()).length<=0?[]:e.split(",")},t.prototype.getTagIds=function(){let e=[];return this.$mainContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__tag:checked").each(function(){e.push(_(this).val())}),e},t.prototype.getTagsFilter=function(){var e=this.$formContainer.find('input[name="sc_tags_filter"]');return e.length<=0||(e=e.val()).length<=0?[]:e.split(",")},t.prototype.getDisplay=function(){return this.$formContainer.find('input[name="sc_display"]').val()},t.prototype.update=function(e=!1,a=""){d(this.$mainContainer);let t=this.$mainContainer.find(".sugar-calendar-block__base-container"),n=(t.addClass("sugar-calendar-block__loading-state"),t.prepend('<div class="sugar-calendar-block__base-container__overlay"><div class="sugar-calendar-block__loading"></div></div>'),this);e={id:this.id,attributes:this.$mainContainer.data("attributes"),calendars:this.getCalendarIds(),venues:this.getVenuesIds(),speakers:this.getSpeakerIds(),calendarsFilter:this.getCalendarsFilter(),venuesFilter:this.getVenuesFilter(),speakersFilter:this.getSpeakersFilter(),tags:this.getTagIds(),tagsFilter:this.getTagsFilter(),day:parseInt(this.$formContainer.find('input[name="sc_day"]').val()),month:parseInt(this.$formContainer.find('input[name="sc_month"]').val()),year:parseInt(this.$formContainer.find('input[name="sc_year"]').val()),search:this.$searchContainer.val(),accentColor:this.$mainContainer.data("accentcolor")?this.$mainContainer.data("accentcolor"):"",display:this.getDisplay(),visitor_tz_convert:parseInt(this.$formContainer.find('input[name="sc_visitor_tz_convert"]').val()),visitor_tz:Intl.DateTimeFormat().resolvedOptions().timeZone,updateDisplay:e,action:a};_.post(sugar_calendar_obj.ajax_url,{action:"sugar_calendar_block_update",calendar_block:e,nonce:sugar_calendar_obj.nonce},function(a){if(a.success){n.$formContainer.find('input[name="sc_day"]').val(a.data.date.day),n.$formContainer.find('input[name="sc_month"]').val(a.data.date.month),n.$formContainer.find('input[name="sc_year"]').val(a.data.date.year),n.$mainContainer.find(".sugar-calendar-block__controls__left__pagination__prev").attr("aria-label",a.data.control_labels.prev),n.$mainContainer.find(".sugar-calendar-block__controls__left__pagination__next").attr("aria-label",a.data.control_labels.next);let e="";switch(n.getDisplay()){case"day":n.$mainContainer.find(".sugar-calendar-block__view-heading").text(a.data.heading),n.$mainContainer.find(".sugar-calendar-block__view-heading-mobile").text(a.data.heading_mobile),n.$mainContainer.find(".sugar-calendar-block__view-heading--year").hide(),a.data.is_update_display&&(n.$mainContainer.find(".sugar-calendar-block__popover__calendar_selector__container__days").hide(),e=sugar_calendar_obj.strings.today);break;case"week":n.$mainContainer.find(".sugar-calendar-block__view-heading").text(a.data.heading),n.$mainContainer.find(".sugar-calendar-block__view-heading-mobile").text(a.data.heading_mobile),n.$mainContainer.find(".sugar-calendar-block__view-heading--year").hide(),a.data.is_update_display&&(n.$mainContainer.find(".sugar-calendar-block__popover__calendar_selector__container__days").show(),n.$mobileListContainer.hide(),e=sugar_calendar_obj.strings.this_week);break;default:n.$mainContainer.find(".sugar-calendar-block__view-heading").text(a.data.heading),n.$mainContainer.find(".sugar-calendar-block__view-heading-mobile").text(a.data.heading_mobile),n.$mainContainer.find(".sugar-calendar-block__view-heading--year").text(a.data.date.year),n.$mainContainer.find(".sugar-calendar-block__view-heading--year").show(),a.data.is_update_display?(n.$mainContainer.find(".sugar-calendar-block__popover__calendar_selector__container__days").show(),n.$mobileListContainer.show(),e=sugar_calendar_obj.strings.this_month):(n.$mainContainer.find(".sugar-calendar-block__base-container__overlay").remove(),t.removeClass("sugar-calendar-block__loading-state"),t=n.$mainContainer.find(".sugar-calendar-block__calendar-month__body"))}""!==e&&n.$mainContainer.find(".sugar-calendar-block__controls__left__pagination__current").text(e),t.html(a.data.body),t.removeClass("sugar-calendar-block__loading-state"),n.displayEvents(),a.data.is_update_display?n.initDatePicker():n.$datePicker.scbootdatepicker("update",new Date(a.data.date.year,a.data.date.month-1,a.data.date.day)),"undefined"!=typeof SCTimeZones&&SCTimeZones.convertEventsTime()}})},t.prototype.getTimeOfDay=function(){return this.$timeOfDayContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__time:checked").map((e,a)=>a.value).get()},t.prototype.getDaysOfWeek=function(){return this.$daysOfWeekContainer.find(".sugar-calendar-block__popover__calendar_selector__container__options__val__day:checked").map((e,a)=>a.value).get()},t.prototype.showMobileEvents=function(e){var a=this.$mobileListContainer.find(".sugar-calendar-block__mobile_event_list__date"),t=this.$mobileListContainer.find(".sugar-calendar-block__mobile_event_list__events_container"),n=(a.html(""),t.html(""),_(e.target));let o;n=(o=n.hasClass("sugar-calendar-block__calendar-month__body__day")?n:_(e.target).parents(".sugar-calendar-block__calendar-month__body__day")).find(".sugar-calendar-block__calendar-month__body__day__events-container");let r=o.data("offsetmonth");(void 0===r||r.length<=0)&&(r=this.$mainContainer.find(".sugar-calendar-block__view-heading").text());var e=sugar_calendar_obj.strings.events_on,i=o.find(".sugar-calendar-block__calendar-month__body__day__number").text().trim();let l=e.replace("[Month Date]",r);i&&(l=l+" "+i),a.text(l),t.html(n.clone()),this.$mobileListContainer.show()},t.prototype.displayEvents=function(){if("week"===this.getDisplay())this.displayEventsOnWeekDisplay();else if("day"===this.getDisplay())this.displayEventsOnDayDisplay();else{let n=this.getTimeOfDay(),o=this.getDaysOfWeek(),r=[],i=this.$mainContainer.find(".sugar-calendar-block__calendar-month");i.find(".sugar-calendar-block__calendar-month__body__day__events-container").each((e,a)=>{let t=_(a);t.find(".sugar-calendar-block__event-cell").each((e,a)=>{a=_(a);(0===o.length||0<_(o).filter([t.data("weekday").toString()]).length)&&(0===n.length||0<_(n).filter(a.data("daydiv")).length)?(a.removeClass("sugar-calendar-block__calendar-month__cell-hide"),r.push(a.data("eventid"))):(a.addClass("sugar-calendar-block__calendar-month__cell-hide"),i.find(".sugar-calendar-block__calendar-month__spacer-eventid-"+a.data("eventid")).addClass("sugar-calendar-block__calendar-month__cell-hide"))})}),r.forEach(e=>{i.find(".sugar-calendar-block__calendar-month__body__day__events-container__event-id-"+e).removeClass("sugar-calendar-block__calendar-month__cell-hide"),i.find(".sugar-calendar-block__calendar-month__spacer-eventid-"+e).removeClass("sugar-calendar-block__calendar-month__cell-hide")})}},t.prototype.filterDisplayWeekView=function(e,t,n,o,r=!1){let i=[];return this.$mainContainer.find(e).each((e,a)=>{a=_(a);0===n.length||0<_(n).filter([a.data("weekday").toString()]).length?a.find(t).each((e,a)=>{var t,n,a=_(a);0===o.length||0<_(o).filter(a.data("daydiv")).length?r?i=(t=i,n=a.data("eventid"),t.includes(n)||t.push(n),t):a.removeClass("sugar-calendar-block__calendar-month__cell-hide"):a.addClass("sugar-calendar-block__calendar-month__cell-hide")}):a.find(t).addClass("sugar-calendar-block__calendar-month__cell-hide")}),i},t.prototype.displayEventsOnWeekDisplay=function(){var e=this.getDaysOfWeek(),a=this.getTimeOfDay();this.filterDisplayWeekView(".sugar-calendar-block__calendar-week__event-slot--all-day",".sugar-calendar-block__calendar-week__event-cell--all-day",e,a,!0).forEach(e=>{this.$mainContainer.find(".sugar-calendar-block__calendar-week__event-cell--id-"+e).removeClass("sugar-calendar-block__calendar-month__cell-hide")}),this.filterDisplayWeekView(".sugar-calendar-block__calendar-week__time-grid__day-col",".sugar-calendar-block__calendar-week__event-cell",e,a)},t.prototype.displayEventsOnDayDisplay=function(){let t=this.getTimeOfDay();0===t.length?this.$mainContainer.find(".sugar-calendar-block__event-cell").removeClass("sugar-calendar-block__calendar-month__cell-hide"):this.$mainContainer.find(".sugar-calendar-block__event-cell").each((e,a)=>{a=_(a);0<_(t).filter(a.data("daydiv")).length?a.removeClass("sugar-calendar-block__calendar-month__cell-hide"):a.addClass("sugar-calendar-block__calendar-month__cell-hide")})},t.prototype.setupDatepickerI18n=function(){var e=sugar_calendar_obj.settings.locale;_.fn.scbootdatepicker.dates[e]={days:sugar_calendar_obj.settings.i18n.days,daysShort:sugar_calendar_obj.settings.i18n.daysShort,daysMin:sugar_calendar_obj.settings.i18n.daysMin,months:sugar_calendar_obj.settings.i18n.months,monthsShort:sugar_calendar_obj.settings.i18n.monthsShort}},{init:function(){_(r).on("load",function(){o.load()})},load:function(){void 0!==r.FloatingUIDOM&&(h=r.FloatingUIDOM,o.initCalendars(),_("body").on("click",o.closePopoversOnBodyClick))},initCalendars:function(){_(".sugar-calendar-block").each(function(){new t(_(this))})},closePopoversOnBodyClick:function(e){var a=_(this);!a.hasClass("sugar-calendar-block__popovers__active")||(e=_(e.target)).hasClass("sugar-calendar-block__controls__left__date")||e.hasClass("sugar-calendar-block__controls__right__settings__btn")||e.hasClass("sugar-calendar-block__controls__right__view__btn")||e.hasClass("sugar-calendar-block__event-cell")||e.hasClass("sugar-calendar-block__popover")||0<e.parents(".sugar-calendar-block__controls__left__date").length||0<e.parents(".sugar-calendar-block__controls__right__settings__btn").length||0<e.parents(".sugar-calendar-block__controls__right__view__btn").length||0<e.parents(".sugar-calendar-block__event-cell").length||0<e.parents(".sugar-calendar-block__popover").length||d(a)}});return o}((document,window),jQuery);sugar_calendar.init();